# Java Lock

### 

### 锁分类

* 公平锁/非公平锁
  * **公平锁** 入锁前如果阻塞会自动排队到链表最后面；

    ```java
    public ReentrantLock(boolean fair) {
        sync = fair ? new FairSync() : new NonfairSync();
    }    
    ```

  * **非公平锁** 谁先抢到，谁先执行；优势为吞吐量较公平锁大，Synchronized为公平锁；
* 可重入锁
  * **可重入锁**又名**递归锁**，是指在同一个线程在外层方法获取锁的时候，在进入内层方法会自动获取锁。
  * ReentrantLock 和 Synchronized 是可重入锁
  * Code View

    ```java
    synchronized void setA() throws Exception{
        Thread.sleep(1000);
        setB();
    }

    synchronized void setB() throws Exception{
        Thread.sleep(1000);
    }
    ```
* 独享锁/共享锁（排它锁）
  * **独享锁**是指该锁一次只能被一个线程所持有。`ReentrantLock & Synchronized & ReentrantReadWriteLock writeLock().lock()`
  * **共享锁**与独占锁相反，可被多个线程持有。`ReentrantReadWriteLock readLock().lock()`

    \`
* 互斥锁/读写锁
  * 互斥锁 ReentrantLock
* 乐观锁/悲观锁
* 分段锁
* 偏向锁/轻量级锁/重量级锁
* 自旋锁

锁消除 锁粗化

类锁 对象锁

无锁



